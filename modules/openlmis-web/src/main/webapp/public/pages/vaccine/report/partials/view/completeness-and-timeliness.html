<!--

 Electronic Logistics Management Information System (eLMIS) is a supply chain management system for health commodities in a developing country setting.

 Copyright (C) 2015  John Snow, Inc (JSI). This program was produced for the U.S. Agency for International Development (USAID). It was prepared under the USAID | DELIVER PROJECT, Task Order 4.

 This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

 This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for more details.

 You should have received a copy of the GNU Affero General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->

<style>
    .ng-table th.sortable div {
        /* css-3 */
        white-space: -o-pre-wrap;
        word-wrap: break-word;
        white-space: pre-wrap;
        white-space: -moz-pre-wrap;
        white-space: -pre-wrap;
    }
    table {
        table-layout: fixed;
        width: 100%;
    }

    .rnr-table {
        padding-top: 0px !important;
    }
    .aggregate-row{
        border-top: 2px #000 solid !important;
    }

</style>
<div class="row-fluid">
<div class="box span12">
<div class="box-header">
    <h2 openlmis-message="report.title.completeness.and.timeliness"><i class="icon-edit"></i><span class="break"></span></h2>
    <div class="box-icon">
        <a id="pdf-button" ng-show="filterForm.$valid" href="" ng-click="exportReport('PDF')" class='btn-small btn-info'><span openlmis-message="label.pdf"></span></a>
        <a id="xls-button" ng-show="filterForm.$valid" href="" ng-click="exportReport('XLS')" class='btn-small btn-info'><span openlmis-message="label.excel"></span></a>
    </div>
</div>
<div class="app-form">
    <form ng-submit="filterGrid()" name="filterForm" novalidate>
        <div  class="clearfix">

            <!--================================ filter start ====================-->
            <div class="horizontalFilters form-cell">
                <label for="zone" class="labels">Regions/Districts</label>
                <div>
                    <select id="zone" ui-select2 class="input-large" data-placeholder="-- All Zones --"  ng-change="OnFilterChanged();" ng-model="filter.zone">
                        <option ng-selected="filter.zone == undefined || filter.zone == '' || filter.zone == 0" value="0">{{user_geo_level}}</option>
                        <optgroup ng-repeat="value in zones.children" value="{{ value.id }}" ng-selected="filter.zone == value.id" label="{{value.name}}">
                            <option ng-selected="filter.zone == value.id" value="{{value.id}}"><b class="green"> -- All of {{value.name}}</b></option>
                            <option ng-repeat-start="v in value.children" ng-selected="filter.zone == v.id" value="{{v.id}}">{{v.name}}</option>
                            <option ng-repeat-end ng-repeat="d in v.children" ng-selected="filter.zone == d.id" value="{{d.id}}"> &nbsp; &nbsp; {{d.name}}</option>
                        </optgroup>
                    </select>
                </div>
            </div>

            <div class="horizontalFilters form-cell">
                <label for="product" class="labels"  openlmis-message="label.product"><span class="label-required">*</span></label>
                <div>
                    <select id="product" ui-select2 class="input-large" ng-model="filter.product" ng-change="OnFilterChanged();">
                        <option value="">---Select product---</option>
                        <option ng-repeat="option in product" value="{{ option.id }}">{{ option.name }}</option>
                    </select>
                </div>
            </div>

            <static-period-filter range="range" startdate="periodStartDate" enddate="periodEnddate" formateddate="my" rangemax="365" error="perioderror"></static-period-filter>
            <!--======================== filter end =========================-->
        </div>
    </form>
    <div style="margin:2px !important;font-size:10px;"  ng-show="periodStartDate" class="row">
        <div class="span4">
            <strong><span openlmis-message="label.start.date"></span></strong>: {{periodStartDate}} &nbsp;&nbsp;&nbsp;&nbsp;
            <strong><span openlmis-message="label.end.date"></span></strong> : {{periodEnddate}}
        </div>
    </div>
    <div style="margin:2px !important;font-size:10px;"  ng-show="perioderror || perioderror1" class="row">
        <div class="span11 ">
            <p style="background-color: #EC4F67;color: #fff;font-size: 11px;">{{perioderror}}</p>
        </div>
    </div>
</div>
<div class="content-body">
    <table class="table table-bordered" ng-show="datarows.length < 1">
        <tr>
            <td>No data to show under selected filters</td>
        </tr>
    </table>
    <div>
        <br/>
        <div id="parent" ng-show="datarows.length > 0">
            <table class="rnr-table table-bordered table">
                <thead>
                <tr>
                    <th rowspan="2">{{getLocalMessage('label.region')}}</th>
                    <th rowspan="2">{{getLocalMessage('label.district')}}</th>
                    <th rowspan="2">{{getLocalMessage('label.period')}}</th>
                    <th rowspan="2">{{getLocalMessage('label.target.population')}}</th>
                    <th colspan="5" style="text-align: center;">{{getLocalMessage('label.reporting.performance')}}</th>
                    <th colspan="3" style="text-align: center;">{{getLocalMessage('label.session.conducted')}}</th>
                </tr>
                <tr>
                    <th>{{getLocalMessage('label.expected')}}</th>
                    <th>{{getLocalMessage('label.reported')}}</th>
                    <th>{{getLocalMessage('label.late')}}</th>
                    <th>{{getLocalMessage('label.percent.reported')}}</th>
                    <th>{{getLocalMessage('label.percent.late')}}</th>
                    <th>{{getLocalMessage('label.fixed')}}</th>
                    <th>{{getLocalMessage('label.outreach')}}</th>
                    <th>{{getLocalMessage('label.total')}}</th>

                </tr>
                <tr>
                    <th colspan="4"></th>
                    <th>{{getLocalMessage('label.A')}}</th>
                    <th>{{getLocalMessage('label.B')}}</th>
                    <th>{{getLocalMessage('label.C')}}</th>
                    <th></th>
                    <th></th>
                    <th>{{getLocalMessage('label.D')}}</th>
                    <th>{{getLocalMessage('label.E')}}</th>
                    <th>{{getLocalMessage('label.F')}}</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="row in datarows">
                    <td >{{ datarows[$index-1].region_name == row.region_name ? '' : row.region_name }}</td>
                    <td >{{ datarows[$index-1].district_name == row.district_name ? '' : row.district_name }}</td>
                    <td  >{{row.period_name}}</td>
                    <td class="number"  >{{row.target}}</td>
                    <td class="number" >{{row.expected}}</td>
                    <td class="number" >{{row.reported}}</td>
                    <td class="number" >{{row.late}}</td>
                    <td class="number" >{{row.percent_reported}}%</td>
                    <td class="number" >{{row.percent_late}}%</td>
                    <td class="number" >{{row.fixed}}</td>
                    <td class="number" >{{row.outreach}}</td>
                    <td class="number" >{{row.session_total}}</td>
                </tr>

                </tbody>
            </table>
            <div ng-show="datarows.length > 0">
                <table id="summary-table" class="rnr-table table-bordered table">
                    <thead >
                    <tr>
                        <th style="width: 19%;"></th>
                        <th ng-repeat="a in summaryPeriodLists">{{a.monthString +' '+ a.year}}</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td  openlmis-message="completeness.and.timliness.number.of.reports.expected"></td>
                        <td  ng-repeat="a in expected">{{a.total}}</td>
                    </tr>
                    <tr>
                        <td openlmis-message="completeness.and.timliness.number.of.reports.recived"></td>
                        <td ng-repeat="ab in reported">{{ab.total}}</td>
                    </tr>
                    <tr>
                        <td  openlmis-message="completeness.and.timliness.number.of.reports.on.time"></td>
                        <td  ng-repeat="abb in ontime">{{abb.total}}</td>
                    </tr>
                    <tr>
                        <td openlmis-message="completeness.and.timliness.completeness"></td>
                        <td ng-repeat="abbb in completeness">{{abbb.total}}</td>
                    </tr>
                    <tr>
                        <td openlmis-message="completeness.and.timliness.timeliness"></td>
                        <td ng-repeat="abbbb in timelines">{{abbbb.total}}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</div>
</div>