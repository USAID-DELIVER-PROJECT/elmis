<!--
  ~ Electronic Logistics Management Information System (eLMIS) is a supply chain management system for health commodities in a developing country setting.
  ~
  ~ Copyright (C) 2015  John Snow, Inc (JSI). This program was produced for the U.S. Agency for International Development (USAID). It was prepared under the USAID | DELIVER PROJECT, Task Order 4.
  ~
  ~ This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->
<div ng-controller="ApproveEquipmentLineItemController">

  <div class="rnr-table regimen-table" tab-scroll bottom-offset="180">
    <table id="equipmentTable" fixed-table-header class="table table-bordered scrollable">
      <thead>
      <tr>
        <th class="col-product" >
          <div class="regimen-heading">
            <span openlmis-message="rnr.equipment.equipment.name"></span>
          </div>
        </th>
        <th class="span3" >
          <div class="regimen-heading">
            <span openlmis-message="rnr.label.non.functional.test.types"></span>
          </div>
        </th>
        <th class="span3" >
          <div class="regimen-heading">
            <span  openlmis-message="rnr.label.no.days.not.functional"></span>
          </div>
        </th>
        <th class="span3" >
          <div class="regimen-heading">
            <span openlmis-message="rnr.label.no.of.test.done"></span>
          </div>
        </th>
        <th class="col-remarks" >
          <div class="regimen-heading">
            <span openlmis-message="rnr.equipment.remarks"></span>
          </div>
        </th>
      </tr>
      </thead>
      <tbody >

      <tr>
        <td class="productCategory" colspan="5" openlmis-message="rnr.label.bio.chemistry.equipment"></td>
      </tr>
      <tr ng-repeat="equipmentLineItem in bioChemistryLineItem = (page.equipment | filter:{isBioChemistryEquipment: true}) ">

        <td class="cell-input padding2px ">
                  <span class="col-product cell-text">
                     <span ng-bind="equipmentLineItem.equipmentName" class="padding2px"></span>
                  </span>
        </td>
        <td class="cell-input padding2px">
          <div class="btn-group dropdown">
            <button id="non-functional-types" type="button"
                    class="btn btn-default dropdown-toggle btn-mini">
              <span openlmis-message="rnr.label.select.non.functional.test.type.show"></span>
              <span class="caret"></span>
            </button>
            <ul onclick="event.stopPropagation();" class="dropdown-menu" style="min-width:210px;">
              <li>
                <label class="checkbox" >
                  <input type="checkbox"
                         style="visibility: visible !important;"
                         ng-checked="equipmentLineItem.electrolytesDaysOutOfUse > 0"  ng-disabled="true"/>
                  <span openlmis-message="rnr.label.electrolytes"></span>
                </label>
              </li>
              <li>
                <label class="checkbox">
                  <input type="checkbox"
                         style="visibility: visible !important;"
                         ng-checked="equipmentLineItem.analytesDaysOutOfUse > 0" ng-disabled="true"/>
                  <span openlmis-message="rnr.label.analytes"></span>
                </label>
              </li>
              <li>
                <label class="checkbox" >
                  <input type="checkbox" ng-disabled="true"
                         style="visibility: visible !important;"
                         ng-model="equipmentLineItem.operationalStatus.isObsolete" />
                  <span openlmis-message="label.obsolete.equipment.status"></span>
                </label>
              </li>
            </ul>
          </div>
        </td>
        <td class="padding2px cell-input ">
          <div class="btn-group dropdown" style="">
            <button id="non-functional-days" type="button"
                    class="btn btn-default dropdown-toggle btn-mini">
              <span openlmis-message="rnr.label.days.not.functional.show"></span>
              <span class="caret"></span>
            </button>
            <ul onclick="event.stopPropagation();" class="dropdown-menu wide">
              <li>
                <div class="row" >
                  <div class="span2">
                    <label class="drop-label" style="font-size: 10px;"
                           for="{{equipmentLineItem.equipmentName}}_electrolytes">
                      <span openlmis-message="rnr.label.electrolytes"></span>
                    </label>
                  </div>
                  <div class="span2">
                    <input ng-disabled="true" type="text"
                           ng-model="equipmentLineItem.electrolytesDaysOutOfUse"
                           id="{{equipmentLineItem.equipmentName}}_electrolytes"></div>
                </div>
              </li>
              <li>
                <div class="row" >
                  <div class="span2">
                    <label class="drop-label" style="font-size: 10px;"
                           for="{{equipmentLineItem.equipmentName}}_analytes">
                      <span openlmis-message="rnr.label.analytes"></span>
                    </label>
                  </div>
                  <div class="span2">
                    <input ng-disabled="true" type="text"
                           ng-model="equipmentLineItem.analytesDaysOutOfUse"
                           id="{{equipmentLineItem.equipmentName}}_analytes"></div>
                </div>
              </li>
            </ul>
          </div>
        </td>
        <td class="cell-input">
          <div class="btn-group dropdown">
            <button id="tests-done" type="button" class="btn btn-default dropdown-toggle btn-mini">
              &nbsp;<span openlmis-message="rnr.label.test.done.show"></span> <span class="caret"></span>
            </button>
            <ul onclick=" event.stopPropagation();" class="dropdown-menu wide scroll">
              <li ng-repeat="(key, value) in equipmentLineItem.bioChemistryTestes | groupBy: 'testTypeName'">
                <div class="row"><strong>{{key}}</strong> <hr style="margin: 4px 0;"/></div>

                <div class="row" ng-repeat="testCount in value" >
                  <div class="span2">
                    <label class="drop-label" style="font-size: 10px;"
                           for="{{equipmentLineItem.equipmentName}}_{{testCount.productName}}">
                      {{testCount.productName}}</label>
                  </div>
                  <div class="span2">
                    <input type="text"
                           ng-disabled="true"
                           id="{{equipmentLineItem.equipmentName}}_{{testCount.productName}}"
                           ng-model="testCount.numberOfTestes" ></div>
                </div>
              </li>
            </ul>
          </div>
        </td>
        <td class="cell-input">
          <span class="cell-text" type="text" ng-bind="equipmentLineItem.remarks" ></span>
        </td>
      </tr>

      <tr ng-show="bioChemistryLineItem.length == 0">
        <td  colspan="5">
                    <span class="padding2px alert alert-info span12" >
                        <small><span openlmis-message="rnr.label.no.bio.chemistry.exist"></span></small>
                    </span>
        </td>
      </tr>
      <tr>
        <td class="productCategory" colspan="5" openlmis-message="rnr.label.all.other.equipment.types"></td>
      </tr>
      <tr ng-repeat="equipmentLineItem in page.equipment | filter:{isBioChemistryEquipment: false} ">
        <td class="cell-input padding2px ">
                  <span class="col-product cell-text">
                    <span ng-bind="equipmentLineItem.equipmentName" class="padding2px"></span>
                  </span>
        </td>
        <td class="cell-input">
          <select ng-disabled="true" class="cell-text" ng-model="equipmentLineItem.operationalStatusId">
            <option  ng-repeat="status in equipmentOperationalStatus" value="{{status.id}}" ng-selected="equipmentLineItem.operationalStatusId === status.id">{{status.name}}</option>
          </select>
        </td>
        <td class="cell-input number">
          <span class="cell-text text-right" type="text" ng-bind="equipmentLineItem.daysOutOfUse"></span>
        </td>
        <td class="cell-input number">
          <span class="cell-text text-right" type="text" ng-bind="equipmentLineItem.testCount"></span>
        </td>
        <td class="cell-input">
          <span class="cell-text" type="text" ng-bind="equipmentLineItem.remarks" ></span>
        </td>
      </tr>
      <tr></tr>
      </tbody>
    </table>
  </div>
</div>